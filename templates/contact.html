{% extends "base.html" %}

{% block content %}
<div class="container py-5">
    <h1 class="mb-4">Contact Us</h1>
    <p class="lead mb-5">Get in touch with our garage door experts for professional service and support.</p>

    <div class="row">
        <div class="col-lg-6 mb-4 mb-lg-0">
            <div class="card">
                <div class="card-body">
                    <form method="POST" action="{{ url_for('contact') }}" class="needs-validation" novalidate>
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        <div class="mb-3">
                            <label for="name" class="form-label">Name</label>
                            <input type="text" class="form-control" id="name" name="name" required 
                                   pattern="[A-Za-z\s]{2,50}" title="Please enter a valid name (2-50 characters)">
                            <div class="invalid-feedback">
                                Please provide your name (2-50 characters, letters only).
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" name="email" required
                                   pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$">
                            <div class="invalid-feedback">
                                Please provide a valid email address.
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="phone" class="form-label">Phone</label>
                            <input type="tel" class="form-control" id="phone" name="phone" required
                                   pattern="^\+?1?\d{9,15}$" title="Please enter a valid phone number">
                            <div class="invalid-feedback">
                                Please provide a valid phone number (9-15 digits).
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="service_type" class="form-label">Service Type</label>
                            <select class="form-select" id="service_type" name="service_type" required>
                                <option value="">Select a service...</option>
                                <option value="assessment">Service Call + Assessment ($35) - Free with any service</option>
                                <option value="spring">Spring Replacement ($380-$400 + tax) - 1-year warranty</option>
                                <option value="cable">Cable Repair ($220-$260 + tax) - 1-year warranty</option>
                                <option value="seal">Retainer and Rubber Seal ($180-$220 + tax) - 1-year warranty</option>
                                <option value="programming">Remote/Keypad Programming ($100-$150 + tax) - 1-year warranty</option>
                                <option value="maintenance">Maintenance and Inspection ($100-$120 + tax) - 1-year warranty</option>
                                <option value="conversion">WD to Spring System Conversion ($500 + tax) - 1-year warranty</option>
                                <option value="track">Track Repair (Free assessment required) - 1-year warranty</option>
                                <option value="roller">Roller Replacement (Free assessment required) - 1-year warranty</option>
                                <option value="emergency">Emergency Service (Same rates apply 24/7) - 1-year warranty</option>
                            </select>
                            <div class="form-text">All services include 1-year comprehensive warranty and free assessment. Prices subject to applicable PST/GST.</div>
                            <div class="invalid-feedback">
                                Please select a service type.
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="message" class="form-label">Message</label>
                            <textarea class="form-control" id="message" name="message" rows="4" required
                                      minlength="10" maxlength="1000"></textarea>
                            <div class="invalid-feedback">
                                Please provide a message (10-1000 characters).
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i data-feather="send" class="me-2"></i>Submit
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title"><i data-feather="clock" class="me-2"></i>Business Hours</h5>
                    <p class="mb-0">
                        Monday - Friday: 8:00 AM - 6:00 PM<br>
                        Saturday: 10:00 AM - 6:00 PM<br>
                        Sunday: 10:00 AM - 6:00 PM
                    </p>
                    <div class="alert alert-warning mt-3 mb-0">
                        <i data-feather="alert-circle" class="me-2"></i>
                        24/7 Emergency Service Available
                    </div>
                </div>
            </div>

            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title"><i data-feather="map-pin" class="me-2"></i>Service Area</h5>
                    <p class="mb-2">Proudly serving Saskatoon and surrounding areas.</p>
                    <div class="alert alert-info mb-0">
                        <i data-feather="info" class="me-2"></i>
                        $35 travel fee applies for locations outside Saskatoon
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-body">
                    <h5 class="card-title"><i data-feather="phone" class="me-2"></i>Direct Contact</h5>
                    <p class="mb-0">
                        <a href="tel:+14747740269" class="text-decoration-none">
                            <i data-feather="phone" class="me-2"></i>(474) 774-0269
                        </a><br>
                        <a href="sms:+14747740269" class="text-decoration-none text-info">
                            <i data-feather="message-square" class="me-2"></i>Send SMS
                        </a><br>
                        <a href="mailto:gdexperts111@gmail.com" class="text-decoration-none">
                            <i data-feather="mail" class="me-2"></i>gdexperts111@gmail.com
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
(function () {
    'use strict'

    const forms = document.querySelectorAll('.needs-validation')
    const submitButton = document.querySelector('button[type="submit"]')

    Array.prototype.slice.call(forms).forEach(function (form) {
        form.addEventListener('submit', function (event) {
            if (!form.checkValidity()) {
                event.preventDefault()
                event.stopPropagation()

                const invalidField = form.querySelector(':invalid')
                if (invalidField) {
                    invalidField.focus()
                }
            } else {
                submitButton.disabled = true
                submitButton.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Submitting...'
            }
            form.classList.add('was-validated')
        }, false)

        const emailInput = form.querySelector('#email')
        const phoneInput = form.querySelector('#phone')
        
        emailInput?.addEventListener('input', function() {
            const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/
            if (emailPattern.test(this.value)) {
                this.setCustomValidity('')
            } else {
                this.setCustomValidity('Please enter a valid email address')
            }
        })

        phoneInput?.addEventListener('input', function() {
            const phonePattern = /^\+?1?\d{9,15}$/
            if (phonePattern.test(this.value)) {
                this.setCustomValidity('')
            } else {
                this.setCustomValidity('Please enter a valid phone number')
            }
        })
    })
})()
</script>
{% endblock %}
{% endblock %}
